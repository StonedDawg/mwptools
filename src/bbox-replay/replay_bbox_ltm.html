<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Jonathan Hudson">
<title>Replay_bbox_ltm.rb</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Replay_bbox_ltm.rb</h1>
<div class="details">
<span id="author" class="author">Jonathan Hudson</span><br>
<span id="email" class="email"><a href="https://github.com/stronnag/mwptools" class="bare">https://github.com/stronnag/mwptools</a></span><br>
<span id="revdate">January 2020</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><code>replay_bbox_ltm.rb</code> is a ruby scrip to transpose Blackbox / INAV flight
data recordings into LTM (LightTelemetry) messages over UDP or serial
(Bluetooth) devices.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Blackbox is an invaluable tool for development and flight analysis for
Cleanflight and its derivatives such as INAV. This program
(<code>replay_bbox_ltm.rb</code>) provides a means to replay a Blackbox recording in a
geospatial context using one of the well know ground stations
<a href="https://github.com/stronnag/mwptools">mwp</a> (Linux) and <a href="http://ez-gui.com/">ezgui</a>
(Android). The LTM (LightTelemetry) protocol is used to replay the
Blackbox log data into the ground station; thus any ground station or
OSD that supports LTM can be used for flight visualisation.</p>
</div>
<div class="paragraph">
<p>Note that <code>replay_bbox_ltm.rb</code> is integrated with <a href="https://github.com/stronnag/mwptools">mwp</a> and replay is available as a menu option. It is not necessary to read this document beyond Dependencies to use <code>replay_bbox_ltm.rb</code> with <a href="https://github.com/stronnag/mwptools">mwp</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_platforms">Platforms</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>replay_bbox_ltm.rb</code> is intended to run on most popular platforms (Linux,
OSX, Windows). It is developed on Arch Linux and tested on Arch,
Fedora, Ubuntu and occasionally, Windows 10.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a number of dependencies that must be satisfied to run the
<code>replay_bbox_ltm.rb</code> script:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Ruby Interpreter;</p>
</li>
<li>
<p>The Ruby 'rubyserial' gem, and for Windows, the win32api gem;</p>
</li>
<li>
<p>The Blackbox utility 'blackbox_decode'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The installation of these dependencies is described below.</p>
</div>
<div class="sect2">
<h3 id="_dependency_installation">Dependency Installation</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Ruby</dt>
<dd>
<p>Version 2.0 or greater is required.</p>
<div class="ulist">
<ul>
<li>
<p>Linux: Install via your distribution package manager.</p>
</li>
<li>
<p>OSX: you can use third-party tools (rbenv and RVM).</p>
</li>
<li>
<p>Windows: Install the latest version from
<a href="http://rubyinstaller.org/downloads/">rubyinstaller.org</a> (aka MRI). Alternately,
the <a href="https://www.cygwin.com/">cygwin</a> version may be used, however this
requires cygwin gcc is also installed to build ffi (a rubyserial
dependency otherwise satisfied by the MRI install). For MRI, set the
options to associate <code>.rb</code> extensions with ruby.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
On Windows, run the environment specific interpreter; running
the MRI (rubyinstaller) interpreter under cygwin may not work as
expected. Using the cygwin ruby is unlikely to work for a serial
device.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
On Ubuntu 14.04 LTS, you must specfically install Ruby 2.0, the
default is 1.9.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo apt install ruby2.0
sudo update-alternatives --install /usr/bin/ruby ruby /usr/bin/ruby2.0 10
sudo update-alternatives --install /usr/bin/gem gem /usr/bin/gem2.0 10</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
rubyserial depends on ffi. If your package manager does not
offer this (it is part of the Windows install, but not default
elsewhere), then you may need to install that as well, either as an
explicit OS package, or via the <code>gem</code> command. rubyserial is an
optional dependency.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For further details, please refer to
<a href="https://www.ruby-lang.org/en/documentation/installation/" class="bare">https://www.ruby-lang.org/en/documentation/installation/</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ruby Serial Gem</dt>
<dd>
<p>This is optional and is only necessary to replay
blackbox files over bluetooth (e.g. it visualise in EzGui); it is not
necessary to replay within <a href="https://github.com/stronnag/mwptools">mwp</a>.
Once you have ruby installed, in a console (CLI)
window:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gem install rubyserial
$ gem install win32api # Windows, excluding cygwin</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Blackbox Utilities</dt>
<dd>
<p>Blackbox is hosted at
<a href="https://github.com/iNavFlight/blackbox-tools/">github</a>. Instructions
are included for all major operating systems. Binary releases for
Windows and OSX are available from
<a href="https://github.com/iNavFlight/blackbox-tools/releases">the releases
page</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><code>blackbox_decode</code> must be on the user&#8217;s PATH when the <code>replay_bbox_ltm.rb</code>
script is invoked.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Installation is as simple as copying the <code>replay_bbox_ltm.rb</code> script
somewhere convenient. The <a href="https://github.com/stronnag/mwptools">mwp</a> installer will install it for you, by default.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_communication_with_the_gs">Communication with the GS</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>replay_bbox_ltm.rb</code> can communicate with the ground station using a UDP
socket or a serial device, typically a Bluetooth device for
communications. At the time of publication, UDP is only supported
by <a href="https://github.com/stronnag/mwptools">mwp</a>.</p>
</div>
<div class="sect2">
<h3 id="_setting_up_serial_communications">Setting up serial communications</h3>
<div class="paragraph">
<p>The easiest way to set up serial comms is to use a USB-TTY adaptor on
the desktop computer running <code>replay_bbox_ltm.rb</code>, with a cross-over
connection to a Bluetooth TTY device, which can then communicate with
EZGUI (or <a href="https://github.com/stronnag/mwptools">mwp</a>, though UDP is easier in this case).</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 20%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">USB</th>
<th class="tableblock halign-left valign-top">BT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5V</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gnd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gnd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RX</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The image below (from the
<a href="http://opwiki.readthedocs.org/en/latest/user_manual/oplink/bluetooth.html">librepilot
wiki</a>) shows the connection.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="bt_connect.png" alt="BT / USB connection">
</div>
</div>
<div class="paragraph">
<p>Usage for ezgui and <a href="https://github.com/stronnag/mwptools">mwp</a> is decribed later.</p>
</div>
<div class="paragraph">
<p>Note that it is <em>possible</em> to use just the computer&#8217;s Bluetooth
device (without a hardware adapter); setting this up is somewhat OS
dependent and beyond the scope of this document. On Linux, one would
use the <code>sdptool add channel=N SP</code> and  <code>rfcomm listen</code> commands.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is <strong><em>essential</em></strong> that <code>blackbox_decode</code> is on the PATH, so either
install it on the extant PATH or extend the PATH to cover the
directory  containing <code>blackbox_decode</code>.</p>
</div>
<div class="sect2">
<h3 id="_verify_the_installation">Verify the installation</h3>
<div class="paragraph">
<p>You can verify the install by running ruby in 'check' mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ruby -cw ./replay_bbox_ltm.rb
Syntax OK</pre>
</div>
</div>
<div class="paragraph">
<p>You should see the 'Syntax OK' message.</p>
</div>
<div class="paragraph">
<p>Next, verify that the application runs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./replay_bbox_ltm.rb --help
replay_bbox_ltm.rb [options] file
Replay bbox log as LTM
    -u, --udp=ADDR                   udp target (localhost:3000)
    -s, --serial-device=DEV
    -i, --index=IDX
    -t, --vehicle-type=TYPE
    -d, --declination=DEC            Mag Declination (default -1.3)
    -g, --force-gps-heading          Use GPS course instead of compass
    -4, --force-ipv4
    -?, --help                       Show this message</pre>
</div>
</div>
<div class="paragraph">
<p>The [options] are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">--udp, -u</dt>
<dd>
<p>When using UDP as the transport for LTM messages, this defines
the UDP host and port. If a host name is given, it is assumed that
the specified host has bound to the defined socket. If the host
name is blank, then <code>replay_bbox_ltm.rb</code> will bind to the socket. The UDP
address is defined as:</p>
<div class="listingblock">
<div class="content">
<pre>  udp://host:port</pre>
</div>
</div>
<div class="paragraph">
<p>The udp:// part may be omitted, so valid examples are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  -u udp://:4321
  --udp :4321
  --udp udp://somehost:4321
  -u somehost:4321</pre>
</div>
</div>
<div class="paragraph">
<p>The first two examples are equivalent, and the last two are
equivalent. By default, <code>replay_bbox_ltm.rb</code> prefers IPv6 where
available. You can force IPv4 with the <code>--force-ipv4</code> option.</p>
</div>
</dd>
<dt class="hdlist1">--serial-device, -s</dt>
<dd>
<p>Defines the serial device, where this is used as
the LTM transport. For example:</p>
<div class="listingblock">
<div class="content">
<pre>  -s /dev/ttyUSB0
  --serial-device /dev/rfcomm1
  -s COM6</pre>
</div>
</div>
<div class="paragraph">
<p>The default baud rate is 115200, this may be changed by appending
@rate to the serial definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  -s /dev/rfcomm2@57600
  -s COM7@38400</pre>
</div>
</div>
</dd>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>Only one of UDP and serial definitions should be given.</p>
</dd>
<dt class="hdlist1">--index, -i</dt>
<dd>
<p>Defines the index of the recording in the the blackbox
file. If this is not given, the first recording (index 1) is used.</p>
</dd>
<dt class="hdlist1">--declination, -d</dt>
<dd>
<p>The magnetic declination in decimal degrees. If not
given, a value appropriate to the New Forest area of southern
England is used.</p>
<div class="paragraph">
<p>You can preset the declination as decimal degrees in a JSON file
<code>$HOME/.config/mwp/replay_ltm.json</code>, as (for the New Forest):</p>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>{"declination":-1}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">--vehicle-type, -t</dt>
<dd>
<p>The vehicle type defines the vehicle icon shown
in mwp or ezgui. Standard MultiWii values are used (mwp interpretation).</p>
<div class="olist arabic">
<ol class="arabic" start="0">
<li>
<p>Undefined (an arrow in mwp, useful for checking the compass)</p>
</li>
<li>
<p>Tricopter</p>
</li>
<li>
<p>Quad+</p>
</li>
<li>
<p>QuadX</p>
</li>
<li>
<p>Bicopter</p>
</li>
<li>
<p>QuadX</p>
</li>
<li>
<p>Y6</p>
</li>
<li>
<p>Hex6+</p>
</li>
<li>
<p>Flying_Wing</p>
</li>
<li>
<p>Y4</p>
</li>
<li>
<p>Hex6X</p>
</li>
<li>
<p>OctoX8</p>
</li>
<li>
<p>OctoFlat+</p>
</li>
<li>
<p>OctoFlatX</p>
</li>
<li>
<p>Aeroplane</p>
</li>
<li>
<p>Heli</p>
</li>
<li>
<p>Heli</p>
</li>
<li>
<p>V-Tail4</p>
</li>
<li>
<p>Hex6+</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">----force-gps-heading, -g</dt>
<dd>
<p>Uses the GPS ground course for vehicle
orientation (instead of compass). For vehicles without a compass
(e.g. fixed wing).</p>
</dd>
<dt class="hdlist1">--force-ipv4, -4</dt>
<dd>
<p>Forces IPv4 (for dual stack systems without full
IPv6 resolvers).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><code>replay_bbox_ltm.rb</code> expects the ground station to poll it (this is normal
<a href="https://github.com/stronnag/mwptools">mwp</a> and ezgui behaviour; both these applications will poll using
MultiWii / Cleanflight identification messages when first
invoked).</p>
</div>
<div class="paragraph">
<p>Typically, when using the ground station with a flight controller, one
first powers up the FC, thus enabling its communications port then
connects from the ground station: <code>replay_bbox_ltm.rb</code> emulates this
behaviour. <code>replay_bbox_ltm.rb</code> provides basic INAV identification messages
to the ground station before broadcasting the blackbox file as LTM
messages.</p>
</div>
<div class="paragraph">
<p>It is also possible to bypass the polling expectation for serial
devices and when invoked as a UDP listener. In these circumstances,
on startup, <code>replay_bbox_ltm.rb</code> displays the message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Waiting for GS to start (RETURN to continue) :</pre>
</div>
</div>
<div class="paragraph">
<p>If you press return before any poll from the ground station,
<code>replay_bbox_ltm.rb</code> will continue; this may be acceptable for serial
connections, however it will cause the application to exit for UDP, as
it does not know the address of the client system. This is intended to
support any client such as an OSD that does not initially poll.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_command_lines">Example Command lines</h3>
<div class="listingblock">
<div class="content">
<pre># replay bbox log, index 2, flying wing, UDP listener
./replay_bbox_ltm.rb -i 2 -t 8 -u :3000 LOG0042.TXT
# replay bbox log, index 1 (default), quadX (default), USB (for ezgui/BT)
./replay_bbox_ltm.rb -s /dev/ttyUSB0 LOG0042.TXT</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connection_examples">Connection examples</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mwp -a -4 -s udp://host:3456</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replay_bbox_ltm.rb -4 -u :3456</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Emulates real world, mwp connects to "FC".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mwp -4 -s udp://:3456</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replay_bbox_ltm.rb -4 -u host:3456</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invoke   mwp first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ezgui, connect to BT device xx:xx:xx:xx:xx:xx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replay_bbox_ltm.rb -s /dev/ttyUSB0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assumes hardware USB / BT "bridge", start replay_bbox_ltm.rb first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mwp -s /dev/rfcomm0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replay_bbox_ltm.rb -s /dev/ttyUSB0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assumes hardware USB / BT "bridge", start replay_bbox_ltm.rb first</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-01-17 10:43:26 UTC
</div>
</div>
</body>
</html>